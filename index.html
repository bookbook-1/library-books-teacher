<script>
    const sheetCsvUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQvgpFiJL5vGTUdZk3u_cnRyXeZ-Ej5u_FC3HihBMHtHs17ZBSObgQe6aWDH3UFIHpu0oKy1TYhcKPP/pub?gid=0&single=true&output=csv";

    async function loadBooks() {
        const gallery = document.getElementById('book-gallery');
        try {
            const response = await fetch(sheetCsvUrl + "&t=" + new Date().getTime());
            const csvText = await response.text();
            
            const rows = csvText.split(/\r?\n/).filter(row => row.trim() !== "");
            
            // ğŸ” ë””ë²„ê¹…: ì‹¤ì œ ì²« ë²ˆì§¸ ë°ì´í„° ì¤„ì´ ì–´ë–»ê²Œ ìƒê²¼ëŠ”ì§€ í™”ë©´ì— ë¿Œë ¤ì¤ë‹ˆë‹¤.
            if (rows.length > 1) {
                alert("ê°€ì ¸ì˜¨ ì²« ë²ˆì§¸ ë°ì´í„°: " + rows[1]); 
            }

            gallery.innerHTML = ''; 
            rows.slice(1).forEach(row => {
                const cols = row.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/);
                // ì¹¸ì´ ë¶€ì¡±í•´ë„ ì¼ë‹¨ ì œëª©ì´ë¼ë„ ë‚˜ì˜¤ê²Œ ê²€ì‚¬ ìˆ˜ì¹˜ë¥¼ 1ë¡œ ë‚®ì·„ìŠµë‹ˆë‹¤.
                if (cols.length >= 1) {
                    const title = cols[0].replace(/"/g, "").trim();
                    const img = cols[4] ? cols[4].trim() : "";
                    const link = cols[5] ? cols[5].trim() : "#";

                    gallery.innerHTML += `
                        <div class="book-card">
                            ${img ? `<img src="${img}">` : '<p>ì´ë¯¸ì§€ ì—†ìŒ</p>'}
                            <div class="title">${title}</div>
                        </div>`;
                }
            });
        } catch (e) { alert("ì—ëŸ¬: " + e.message); }
    }
    loadBooks();
</script>
